#!/usr/bin/env bash
# Email: xealea@proton.me

# set
run() {
	if ! pgrep -f "$1" ; then
		"$@"&
	fi
}

# Init DIR
DIR="$HOME/.config"

# Kill already running process
for _prs in xsettingsd ksuperkey; do
    pid=$(pidof $_prs)
    [[ -n $pid ]] && kill -9 $pid
done

# Environment variables
export QT_QPA_PLATFORMTHEME="gtk3"
export VISUAL="nvim"
export EDITOR="geany"
export TERM="alacritty"
export HISTCONTROL="ignoredups:erasedups"
export XCURSOR_THEME="oreo_white_cursors xclock"

# Set other env
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_DATA_HOME="$HOME/.local/share"
export XDG_CACHE_HOME="$HOME/.cache"

# Xdeb for voidlinux
export XDEB_OPT_DEPS="true"
export XDEB_OPT_SYNC="true"
export XDEB_OPT_WARN_CONFLICT="true"
export XDEB_OPT_FIX_CONFLICT="true"

# Nyoom
export NVIM_APPNAME="nvim"

# Path my script
export PATH="$DIR/nvim/bin:$HOME/.local/bin:$PATH"

# polkit agent
if ! pidof xfce-polkit; then
    exec /usr/lib/xfce-polkit/xfce-polkit &
fi

# Run processes
run ~/.fehbg &
run nm-applet &
run xfsettingsd &
run blueman-applet &
run xfce4-power-manager &
run xsetroot -cursor_name left_ptr &
run picom --config "$DIR/picom.conf" --daemon &
run xsettingsd --config="$DIR/xsettingsd/xsettingsd.conf" &
run /usr/lib/xfce4/notifyd/xfce4-notifyd
