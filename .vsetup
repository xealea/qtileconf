#!/usr/bin/env bash
# Email: xealea@proton.me

# Source environment variables
source "$HOME/.envvars"

# Init DIR
DIR="$HOME/.config"

# set
run() {
  if ! pgrep -f "$1" ; then
    "$@" &
  fi
}

# Kill already running process
for _prs in xsettingsd dunst ksuperkey; do
    pid=$(pidof $_prs)
    [[ -n $pid ]] && kill -9 $pid
done

# polkit agent
if ! pidof xfce-polkit; then
    run /usr/lib/xfce-polkit/xfce-polkit &
fi

# Run processes
run ~/.fehbg
run pipewire &
run nm-applet &
run xfsettingsd &
run blueman-applet &
run /usr/bin/dunst &
run xfce4-power-manager &
run xsetroot -cursor_name left_ptr &
run picom --config "$DIR/picom.conf" --daemon &
run xsettingsd --config="$DIR/xsettingsd/xsettingsd.conf"
